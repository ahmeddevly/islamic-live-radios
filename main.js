        const RADIO_STATIONS = [
            {
                id: "athkar_masa",
                title: "إذاعة أذكار المساء",
                badge: "أذكار",
                description: "بث مستمر لأذكار المساء مع تلاوات مختارة.",
                src: "https://qurango.net/radio/athkar_masa",
                tags: "أذكار المساء ذكر دعاء adhkar evening"
            },
            {
                id: "tafseer",
                title: "إذاعة تفسير القرآن الكريم",
                badge: "تفسير",
                description: "شرح وتفسير لآيات القرآن الكريم من علماء موثوقين.",
                src: "https://qurango.net/radio/tafseer",
                tags: "تفسير القرآن تفسير دروس علم tafseer"
            },
            {
                id: "quran_cairo",
                title: "إذاعة القرآن الكريم من القاهرة",
                badge: "بث رسمي",
                description: "تلاوات وبرامج إذاعة القرآن الكريم المصرية.",
                src: "https://stream.radiojar.com/8s5u5tpdtwzuv",
                tags: "القرآن الكريم القاهرة مصر راديو quran cairo official",
                featured: true
            },
            {
                id: "tarateel",
                title: "قرآن مباشر",
                badge: "قرآن",
                description: "تلاوات متواصلة لعدة قرّاء بصوت نقي.",
                src: "https://qurango.net/radio/tarateel",
                tags: "قرآن مباشر ترتيل quran live"
            },
            {
                id: "roqiah",
                title: "إذاعة الرقية الشرعية",
                badge: "رقية",
                description: "آيات الرقية الشرعية المختارة من القرآن الكريم.",
                src: "https://qurango.net/radio/roqiah",
                tags: "رقية شرعية علاج roqya"
            },
            {
                id: "algeria_quran",
                title: "إذاعة القرآن الكريم من الجزائر",
                badge: "بث رسمي",
                description: "الإذاعة الجزائرية الرسمية للقرآن الكريم.",
                src: "https://webradio.tda.dz/Coran_64K.mp3",
                tags: "الجزائر القرآن الكريم الجزائرية quran algeria official"
            },
            {
                id: "saudi_quran",
                title: "إذاعة القرآن الكريم السعودية",
                badge: "بث رسمي",
                description: "بث مباشر لإذاعة القرآن الكريم من المملكة العربية السعودية.",
                src: "https://stream.radiojar.com/4wqre23fytzuv",
                tags: "السعودية إذاعة القرآن السعودية quran saudi"
            },
            {
                id: "makkah_tv",
                title: "قناة مكة Makkah TV بث مباشر (صوت)",
                badge: "بث حي",
                description: "بث صوتي مباشر من قناة مكة بأجواء روحانية.",
                src: "http://r1.tarat.com:8202/",
                tags: "قناة مكة makkah tv بث مباشر"
            },
            {
                id: "altablawy",
                title: "إذاعة الشيخ محمد الطبلاوي",
                badge: "قارئ",
                description: "تلاوات نادرة ومؤثرة للشيخ محمد الطبلاوي.",
                src: "https://qurango.net/radio/mohammad_altablaway",
                tags: "الشيخ الطبلاوي تلاوات quran"
            },
            {
                id: "mustafa_ismail",
                title: "إذاعة الشيخ مصطفى إسماعيل",
                badge: "قارئ",
                description: "تلاوات خاشعة للشيخ مصطفى إسماعيل.",
                src: "https://qurango.net/radio/mustafa_ismail",
                tags: "الشيخ مصطفى اسماعيل quran"
            },
            {
                id: "abdulbasit",
                title: "إذاعة الشيخ عبدالباسط عبدالصمد",
                badge: "قارئ",
                description: "تلاوات مجودّة للشيخ عبدالباسط عبدالصمد.",
                src: "https://qurango.net/radio/abdulbasit_abdulsamad_mojawwad",
                tags: "الشيخ عبدالباسط عبد الصمد quran"
            },
            {
                id: "haram_makki",
                title: "إذاعة الحرم المكي",
                badge: "بث حي",
                description: "صوتيات مباشرة من المسجد الحرام بمكة المكرمة.",
                src: "http://r7.tarat.com:8004/",
                tags: "الحرم المكي مكة بث الحرم"
            },
            {
                id: "sakeenah",
                title: "إذاعة آيات السكينة",
                badge: "سكينة",
                description: "بث متواصل لآيات السكينة والطمأنينة.",
                src: "https://qurango.net/radio/sakeenah",
                tags: "آيات السكينة راحة سكينة tranquility"
            },
            {
                id: "eid_takbeer",
                title: "إذاعة تكبيرات العيد",
                badge: "تكبيرات",
                description: "تكبيرات العيد بصوت جميل تبعث أجواء العيد.",
                src: "https://qurango.net/radio/eid",
                tags: "تكبيرات العيد عيد الأضحى عيد الفطر takbeer"
            },

            {
                id: "saud_alshuraim",
                title: "إذاعة الشيخ سعود الشريم",
                badge: "قارئ",
                description: "تلاوات خاشعة للشيخ سعود الشريم من الحرم المكي.",
                src: "https://qurango.net/radio/saud_alshuraim",
                tags: "سعود الشريم الحرم المكي quran"
            },
            {
                id: "abu_bakr_shatri",
                title: "إذاعة الشيخ أبو بكر الشاطري",
                badge: "قارئ",
                description: "تلاوات مميزة للشيخ أبو بكر الشاطري.",
                src: "https://qurango.net/radio/shaik_abu_bakr_al_shatri",
                tags: "أبو بكر الشاطري quran"
            },
            {
                id: "fares_abbad",
                title: "إذاعة الشيخ فارس عباد",
                badge: "قارئ",
                description: "تلاوات مؤثرة للشيخ فارس عباد.",
                src: "https://qurango.net/radio/fares_abbad",
                tags: "فارس عباد quran"
            },
            {
                id: "mohammed_ayyub",
                title: "إذاعة الشيخ محمد أيوب",
                badge: "قارئ",
                description: "تلاوات منوعة للشيخ محمد أيوب.",
                src: "https://qurango.net/radio/mohammed_ayyub",
                tags: "محمد أيوب quran"
            },
            {
                id: "jamal_shaker",
                title: "إذاعة الشيخ جمال شاكر عبدالله",
                badge: "قارئ",
                description: "تلاوات عذبة للشيخ جمال شاكر عبدالله.",
                src: "https://qurango.net/radio/jamal_shaker_abdullah",
                tags: "جمال شاكر عبدالله quran"
            },

            {
                id: "quran_live_global",
                title: "Quran Live Global Radio",
                badge: "عالمي",
                description: "محطة عالمية تبث القرآن على مدار الساعة من قرّاء متعددين.",
                src: "https://qurango.net/radio/tarateel", 
                tags: "quran live global worldwide islamic radio"
            }
        ];

        document.getElementById("currentYear").textContent = new Date().getFullYear();

        const radiosContainer = document.getElementById("radiosContainer");
        const searchInput = document.getElementById("searchInput");
        const stopAllBtn = document.getElementById("stopAllBtn");
        const noResultsMessage = document.getElementById("noResultsMessage");

        function createRadioCard(station) {
            const article = document.createElement("article");
            article.className = "radio-card";
            if (station.featured) article.classList.add("active");
            article.dataset.tags = station.tags || "";

            article.setAttribute("tabindex", "0");
            article.setAttribute("role", "group");
            article.setAttribute("aria-label", station.title);

            const header = document.createElement("div");
            header.className = "radio-header";

            const titleEl = document.createElement("h3");
            titleEl.className = "radio-title";
            titleEl.textContent = station.title;

            const badge = document.createElement("span");
            badge.className = "radio-badge";
            badge.textContent = station.badge || "إسلامي";

            const meta = document.createElement("p");
            meta.className = "radio-meta";
            meta.textContent = station.description || "";

            const audio = document.createElement("audio");
            audio.controls = true;
            audio.preload = "none";
            audio.src = station.src;
            audio.setAttribute("aria-label", "استمع إلى " + station.title);

            header.appendChild(titleEl);
            header.appendChild(badge);
            article.appendChild(header);
            article.appendChild(meta);
            article.appendChild(audio);

            article.addEventListener("keydown", (e) => {
                if (e.key === "Enter" || e.key === " ") {
                    e.preventDefault();
                    if (audio.paused) audio.play(); else audio.pause();
                }
            });

            return article;
        }

        function renderRadios(list) {
            radiosContainer.innerHTML = "";
            list.forEach(station => {
                radiosContainer.appendChild(createRadioCard(station));
            });
            attachAudioHandlers();
        }

        function allAudios() {
            return Array.from(document.querySelectorAll("audio"));
        }

        function stopAll() {
            allAudios().forEach(audio => {
                audio.pause();
                audio.currentTime = 0;
            });
            Array.from(document.querySelectorAll(".radio-card")).forEach(card =>
                card.classList.remove("active")
            );
        }

        function attachAudioHandlers() {
            const cards = Array.from(document.querySelectorAll(".radio-card"));
            allAudios().forEach(audio => {
                audio.addEventListener("play", () => {
                    allAudios().forEach(other => {
                        if (other !== audio) other.pause();
                    });
                    cards.forEach(card => card.classList.remove("active"));
                    const parentCard = audio.closest(".radio-card");
                    if (parentCard) parentCard.classList.add("active");
                });
            });
        }

        function filterRadios(query) {
            const normalizedQuery = query.trim().toLowerCase();
            let visibleCount = 0;

            Array.from(radiosContainer.children).forEach(card => {
                const title = card.querySelector(".radio-title")?.textContent || "";
                const tags = card.dataset.tags || "";
                const haystack = (title + " " + tags).toLowerCase();

                const matches = normalizedQuery === "" || haystack.includes(normalizedQuery);
                card.style.display = matches ? "" : "none";
                if (matches) visibleCount++;
            });

            if (visibleCount === 0 && normalizedQuery !== "") {
                noResultsMessage.classList.remove("sr-only");
            } else {
                noResultsMessage.classList.add("sr-only");
            }
        }

        stopAllBtn.addEventListener("click", () => {
            stopAll();
            stopAllBtn.setAttribute("aria-pressed", "false");
        });

        searchInput.addEventListener("input", (e) => {
            filterRadios(e.target.value);
        });

        function updateDateTime() {
            const now = new Date();

            const arabicDays = ['الأحد', 'الإثنين', 'الثلاثاء', 'الأربعاء', 'الخميس', 'الجمعة', 'السبت'];
            const dayName = arabicDays[now.getDay()];

            const gregOptions = {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            };
            const gregDate = now.toLocaleDateString('ar-EG', gregOptions);
            const gregTime = now.toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true });

            const hijriOptions = {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                calendar: 'islamic-umalqura'
            };
            const hijriDate = now.toLocaleDateString('ar-SA-u-ca-islamic-umalqura-nu-arab', hijriOptions);

            const gregElement = document.getElementById('gregorianDateTime');
            const hijriElement = document.getElementById('hijriDate');

            if (gregElement) {
                gregElement.textContent = `${dayName} ${gregDate} - ${gregTime}`;
            }

            if (hijriElement) {
                hijriElement.textContent = `${hijriDate} هـ`;
            }
        }

        updateDateTime();
        setInterval(updateDateTime, 1000);

        renderRadios(RADIO_STATIONS);
